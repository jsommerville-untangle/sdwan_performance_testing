version: '3.3'
services:
    perf-server:
        build:
            context: .
            dockerfile: Dockerfile.perf-server
        network_mode: host
        env_file:
            - .env.server
    perf-client:
        build:
            context: .
            dockerfile: Dockerfile.perf-client
        env_file:
            - .env.client
    perf-results-sshd:
        build:
            context: .
            dockerfile: Dockerfile.perf-results-sshd
        env_file:
            - .env.results
        # Expose Web service on 8080 and SSH on the RES_PORT
        ports:
            - "${RES_SSH_PORT}:22"
        volumes:
            - /data/performance-results:/data/
    perf-results-nginx:
        build:
            context: .
            dockerfile: Dockerfile.perf-results-nginx
        env_file:
            - .env.results
        # Expose Web service on 8080 and SSH on the RES_PORT
        ports:
            - "8080:80"
        volumes:
            - /data/performance-results:/data/